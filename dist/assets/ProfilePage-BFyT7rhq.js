import{c as w,u as b,r as a,j as e,C as N,A as y,S as j,J as v,M as S}from"./index-UI3Zajj_.js";import{S as P}from"./square-pen-COzZYZqp.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=w("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),k=()=>{const{changePassword:s,signOut:p,loading:c}=b(),[t,f]=a.useState(""),[l,u]=a.useState(""),[i,x]=a.useState(!1),[d,n]=a.useState(""),[m,h]=a.useState(""),g=async r=>{if(r.preventDefault(),n(""),h(""),t!==l){n("New passwords do not match.");return}try{x(!0),await s(t,!1),h("Password changed successfully!"),f(""),u("")}catch(o){n(o.message||"Failed to change password.")}finally{x(!1)}};return e.jsxs("form",{onSubmit:g,className:"max-w-md mx-auto p-6 bg-white rounded-xl shadow-md",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Change Password"}),d&&e.jsx("p",{className:"text-red-500 mb-2",children:d}),m&&e.jsx("p",{className:"text-green-500 mb-2",children:m}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block mb-1 text-sm font-medium",children:"New Password"}),e.jsx("input",{type:"password",value:t,onChange:r=>f(r.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-emerald-500 focus:border-emerald-500",placeholder:"Enter new password"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block mb-1 text-sm font-medium",children:"Confirm Password"}),e.jsx("input",{type:"password",value:l,onChange:r=>u(r.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-emerald-500 focus:border-emerald-500",placeholder:"Confirm new password"})]}),e.jsx("button",{type:"submit",disabled:i||c||!t||!l,className:"w-full py-2 px-4 bg-emerald-600 text-white font-medium rounded-md hover:bg-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:i||c?"Updating password...":"Update Password"})]})};function L(){var g;const{user:s,refreshUser:p}=b(),[c,t]=a.useState((s==null?void 0:s.full_name)||""),[f,l]=a.useState(!1),[u,i]=a.useState(!1),[x,d]=a.useState(null),[n,m]=a.useState(!1);a.useEffect(()=>{s&&t(s.full_name||"")},[s]);const h=async r=>{if(r.preventDefault(),d(null),m(!1),i(!0),!s){d("User not authenticated."),i(!1);return}try{const{error:o}=await S.from("users").update({full_name:c}).eq("id",s.id);if(o)throw o;await p(),d("Profile updated successfully!"),m(!0),l(!1)}catch(o){d(o instanceof Error?o.message:"Failed to update profile."),m(!1)}finally{i(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"User Profile"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"View and manage your personal information and password."})]}),x&&e.jsxs("div",{className:`p-4 rounded-md ${n?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"} flex items-start`,children:[n?e.jsx(N,{className:"h-5 w-5 text-green-400 mt-0.5 mr-3 flex-shrink-0"}):e.jsx(y,{className:"h-5 w-5 text-red-400 mt-0.5 mr-3 flex-shrink-0"}),e.jsx("div",{className:`text-sm ${n?"text-green-700":"text-red-700"}`,children:x})]}),e.jsxs("div",{className:"bg-white shadow-sm rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"Personal Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(C,{className:"h-5 w-5 text-gray-500 mr-3"}),e.jsxs("p",{className:"text-gray-700",children:["Email: ",e.jsx("span",{className:"font-medium",children:s==null?void 0:s.email})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(j,{className:"h-5 w-5 text-gray-500 mr-3"}),e.jsxs("p",{className:"text-gray-700",children:["Role: ",e.jsx("span",{className:"font-medium",children:((g=s==null?void 0:s.roles)==null?void 0:g.name)||"No role assigned"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(v,{className:"h-5 w-5 text-gray-500 mr-3"}),f?e.jsxs("form",{onSubmit:h,className:"flex items-center w-full",children:[e.jsx("input",{type:"text",value:c,onChange:r=>t(r.target.value),className:"flex-1 border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500 mr-2",placeholder:"Full Name",required:!0}),e.jsx("button",{type:"submit",disabled:u,className:"px-4 py-2 text-sm font-medium text-white bg-emerald-600 hover:bg-emerald-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Saving...":"Save"}),e.jsx("button",{type:"button",onClick:()=>{l(!1),t((s==null?void 0:s.full_name)||"")},className:"ml-2 px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md",children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-gray-700",children:["Full Name: ",e.jsx("span",{className:"font-medium",children:(s==null?void 0:s.full_name)||"Not set"})]}),e.jsxs("button",{onClick:()=>l(!0),className:"ml-auto inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded-md text-emerald-700 bg-emerald-100 hover:bg-emerald-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500",children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Edit"]})]})]})]})]}),e.jsxs("div",{className:"bg-white shadow-sm rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"Change Password"}),e.jsx(k,{})]})]})}export{L as ProfilePage};
